<!DOCTYPE html>
<html lang="en">
<head>
    {% include 'header.html' %}
</head>
<body>
    <div class="attendance-container">
        <h1>Attendance Records</h1>
        <p>Welcome, {{ lecturer_name }}! Use the filter below to view attendance by class:</p>

        <!-- Form chọn lớp -->
        <form method="POST" action="{{ url_for('attendance_view') }}">
            <label for="class_filter">Filter by Class:</label>
            <select name="class_filter" id="class_filter">
                <option value="">All Classes</option>
                {% for class in classes %}
                    <option value="{{ class }}" {% if class == selected_class %} selected {% endif %}>{{ class }}</option>
                {% endfor %}
            </select>
            <button type="submit">Tìm kiếm</button>
        </form>
        
        <!-- Bảng điểm danh -->
        <table>
            <thead>
                <tr>
                    <th>IDSV</th>
                    <th>Name</th>
                    <th>Class</th>
                    <th>Timestamp</th>
                    <th>IP Address</th>
                </tr>
            </thead>
            <tbody>
                {% set reference_ip = records[0].ip_address if records else None %} <!-- Set the reference IP -->
                {% for record in records %}
                <tr {% if record.ip_address != reference_ip %}style="background-color: #ffcccc;"{% endif %}>
                    <td>{{ record.idsv }}</td>
                    <td>{{ record.users_name }}</td>
                    <td>{{ record.class }}</td>
                    <td>{{ record.timestamp }}</td>
                    <td>{{ record.ip_address }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>              
    </div>
    <footer>© Code by NTA</footer>
</body>
{% include 'footer.html' %}
</html>
